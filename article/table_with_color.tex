% !TeX TS-program = pdflatex
% source from  https://tex.stackexchange.com/questions/33758/professional-looking-tables-with-alternating-row-colors
% https://tex.stackovernet.com/cn/q/29077
\documentclass[fontset=none]{ctexart}
\setCJKmainfont[BoldFont={FZHei-B01},ItalicFont={FZKai-Z03}]{FZShuSong-Z01}
\setCJKsansfont{FZHei-B01}

\usepackage[margin=2.5cm]{geometry}

\usepackage{newtxtext}

\usepackage{graphicx}
\usepackage{booktabs,colortbl}
\usepackage{xcolor}

\title{\bfseries 给三线表格加颜色}
\author{\includegraphics[width=4cm]{latexstudio.pdf}}

\colorlet{tableheadcolor}{gray!25} % Table header colour = 25% gray
\newcommand{\headcol}{\rowcolor{tableheadcolor}} %

\colorlet{tablerowcolor}{gray!10} % Table row separator colour = 10% gray

\newcommand{\rowcol}{\rowcolor{tablerowcolor}} %
% Command \topline consists of a (slightly modified) \toprule followed by a \heavyrule rule of colour tableheadcolor (hence, 2 separate rules)
\newcommand{\topline}{\arrayrulecolor{black}\specialrule{0.1em}{\abovetopsep}{0pt}%
	\arrayrulecolor{tableheadcolor}\specialrule{\belowrulesep}{0pt}{0pt}%
	\arrayrulecolor{black}}
% Command \midline consists of 3 rules (top colour tableheadcolor, middle colour black, bottom colour white)

\newcommand{\bottomlinec}{\arrayrulecolor{tablerowcolor}\specialrule{\aboverulesep}{0pt}{0pt}%
	\arrayrulecolor{black}\specialrule{\heavyrulewidth}{0pt}{\belowbottomsep}}%
\colorlet{blcolor}{gray!80}
\newcommand{\rowmidlineHR}{\arrayrulecolor{tableheadcolor}
	\specialrule{\aboverulesep}{0pt}{0pt}%
	\arrayrulecolor{black}\specialrule{\lightrulewidth}{0pt}{0pt}%
	\arrayrulecolor{tablerowcolor}\specialrule{\belowrulesep}{0pt}{0pt}%
	\arrayrulecolor{black}}
% Command \rowmidlinewc consists of 3 rules
% (top colour tableheadcolor, middle colour black, bottom colour tablerowcolor)
\newcommand{\rowmidlineG}{\arrayrulecolor{tablerowcolor}%
	\specialrule{\aboverulesep}{0pt}{0pt}%
	\arrayrulecolor{blcolor}\specialrule{\lightrulewidth}{0pt}{0pt}%
	\arrayrulecolor{tablerowcolor}\specialrule{\belowrulesep}{0pt}{0pt}%
	\arrayrulecolor{black}}
\begin{document}
	\maketitle
	\large
	
	通常三线表格是不能加颜色装饰，装饰之后会出现上线很多间距的空白区域，本文给出了新的填充办法，有需要的用户可以复制代码自己使用。
	% Command \rowmidlineG consists of 3 rules
	% (top colour tablerowcolor, middle colour black, bottom colour tablerowcolor)
	\begin{table} [htpb]
		\centering 
		\centering
		\caption{Size and shape distribution for a sampled rock riprap}
		\label{tab:size_shape}
		\begin{tabular} { p{0.2\textwidth}  p{0.15\textwidth} p{0.10 \textwidth} p{0.10 \textwidth} p{0.15 \textwidth}  }
			\topline
			\headcol & Small  &  Medium &  Large & Shape fraction \\
			\rowmidlineHR  % Head Rule
			\rowcol Compact    & 10\% &  44\% & 7\% & 61\% \\
			\rowcol Flat       & 4\%  &  10\% & 4\% & 18\% \\
			\rowcol Elongated  & 5\%  &  12\% & 4\% & 21\% \\
			\rowmidlineG % Gray midline
			\rowcol Size fraction  & 19\% & 66\% & 15\% & 100\% \\
			\bottomlinec
		\end{tabular}
	\end{table}
\end{document}